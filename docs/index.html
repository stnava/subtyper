<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Informative Title for Your Package • subtyper</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Informative Title for Your Package">
<meta property="og:description" content='A longer statement about what this does. It must have at least one
    complete sentence, and it may not begin with the name of the package or
    "This package". Any URL must be enclosed in angle brackets. Any R packages
    or other software you reference must be in single quotes. R CMD check
    may not report on these, but see  &lt;https://cran.r-project.org/doc/manuals/r-release/R-exts.html#The-DESCRIPTION-file&gt;.
    Failure to obey may result in CRAN rejecting your package submission.'>
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">subtyper</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="articles/subtyper.html">Get started</a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/stnava/subtyper/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">

<div id="subtyper" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#subtyper" class="anchor"></a>subtyper</h1></div>

<p>documentation page <a href="https://stnava.github.io/subtyper/">here</a></p>
<div id="subtype-and-staging-analyses-in-disease-modeling" class="section level2">
<h2 class="hasAnchor">
<a href="#subtype-and-staging-analyses-in-disease-modeling" class="anchor"></a>Subtype and staging analyses in disease modeling</h2>
<p>Common tasks for subtyping include making measurements of data consistency, <em>filtering</em> for good subjects, training the subtyping algorithm, predicting the subtypes in new data and visualizing results, often over time.</p>
<p>This package expects population-level data frames with longitudinal data.</p>
</div>
</div>
<div id="overview-of-subtyper" class="section level1">
<h1 class="hasAnchor">
<a href="#overview-of-subtyper" class="anchor"></a>Overview of <code>subtyper</code>
</h1>
<p>Subtyper is a package for defining subtypes in patient populations based on data. A “subtyping method” uses data to classify subjects into groups that represent different disease etiologies, different progression paths or different sets of symptoms potentially arising from the same underlying pathology. Subtyping therefore tries to identify smaller but distinctive groups within an overall disorder.</p>
<p>Subtyping methods must be predictive. That is, they follow a machine learning style with a “training” phase for the models followed by inference wherein we apply the fixed models to new data. Subtyper’s design follows this paradigm which will be seen in the examples below. While we only use linear regression here, the basic principles can extend to other modeling techniques including deep learning.</p>
<p>Subtyping and “staging” are or may be inter-related. For example, some sub-types may only be identifiable at a given disease stage. Other subtypes are fundamentally different across all disease stages (e.g. genetic forms of AD or PD vs idiopathic forms). In PD, some patients “jump” between classically defined subtypes (see 2021 Lancet review on PD diagnosis). Ths package does not claim to produce “good” subtypes. It’s just a tool that allows one to test and visualize different approaches to subtyping whether they are stage-specific or not.</p>
<div id="generic-processing-steps" class="section level2">
<h2 class="hasAnchor">
<a href="#generic-processing-steps" class="anchor"></a>Generic processing steps</h2>
<p>The brief code block below shows us the core steps in <code>subtyper</code>. We will comment on each step within its own section.</p>
<pre class="{r}"><code><a href="https://github.com/stnava/subtyper">library(subtyper)
mydf = generateSubtyperData( 100 )
rbfnames = names(mydf)[grep("Random",names(mydf))]
mydf = outlierness( mydf, rbfnames )
mydf = highestQualityRepeat( mydf, "Id", "visit", "OL_KNN_SUM")
qdf = trainSubtypeUni( mydf, "cognition", c("C0","C1","C2"), c(0.33,0.66) )
pdf = predictSubtypeUni( mydf, qdf, "Id" )</a></code></pre>
</div>
<div id="example-data" class="section level2">
<h2 class="hasAnchor">
<a href="#example-data" class="anchor"></a>Example data</h2>
<p>The function:</p>
<pre class="{r}"><code>mydf = generateSubtyperData( 100 )</code></pre>
<p>simply supplies a dataframe that fits our assumptions about how data is organized.</p>
<ul>
<li><p>subject IDs are provided</p></li>
<li><p>each subject has one or more “visits”</p></li>
<li><p>at each visit, there may be more than one repeats of a measurement</p></li>
<li><p>there is some measurement of the quality of each measurement (optional)</p></li>
</ul>
<p>While our simulated data is complete, in reality, many subjects may be missing data. We can further simulate this (at random) by performing:</p>
<pre class="{r}"><code>nrows = nrow( mydf )
mixna = sample(1:nrows,10)
mydf[ mixna, "cognition" ] = NA</code></pre>
</div>
<div id="outlierness" class="section level2">
<h2 class="hasAnchor">
<a href="#outlierness" class="anchor"></a>Outlierness</h2>
<p>While we assume that the data comes with some quality measurements (domain specific), we may also use data-driven approaches to measuring how close each timepoint-repeat is to related data. If such a datapoint is “far away” from its nearest neighbors, then it is likely to be an outlier. The <code>outlierness</code> function implements several methods for making such estimations which can guide data inspection.</p>
<pre class="{r}"><code>rbfnames = names(mydf)[grep("Random",names(mydf))]
mydf = outlierness( mydf, rbfnames )</code></pre>
<p>These outlierness measurements are added to the data frame by the above call. The names are prepended with “OL_”. Which particular measurement – or set of measurements – is best may depend on your dataset.</p>
<p>It is important to note that these methods are likely to be more generalizable if they are trained and applied to data that is “good” quality.</p>
<p><strong>Warning:</strong> Some subjects will always be outliers according to these methods. However, that does not mean they should be rejected. Decisions about data rejection should be put off to the last possible moment. Another option is to simply covary for the outlierness score — with the assumption that the score is not or is only marginally related to the outcomes of interest.</p>
</div>
<div id="filter-for-quality" class="section level2">
<h2 class="hasAnchor">
<a href="#filter-for-quality" class="anchor"></a>Filter for quality</h2>
<p>Given the above comments, we might want to find the “best” repeat for each time point in the case when there are multiple repeats. Here, we use the <code>OL_KNN_SUM</code> score as an outlierness measurement.</p>
<pre class="{r}"><code>mydf = highestQualityRepeat( mydf, "Id", "visit", "OL_KNN_SUM")</code></pre>
</div>
<div id="covariate-adjustment" class="section level2">
<h2 class="hasAnchor">
<a href="#covariate-adjustment" class="anchor"></a>Covariate adjustment</h2>
<p>The function <code>adjustByCovariates</code> can be used to train and predict covariate adjusted scores. Here, we train the adjustment based on group <code>G0</code> and adjust with respect to <code>RandomBasisProjection01</code>. In practice, these variables may include age, sex and other nuisance variables.</p>
<pre class="{r}"><code>myform = "cognition ~ RandomBasisProjection01 "
mydf = adjustByCovariates(mydf,myform,"DX","G0")</code></pre>
</div>
<div id="train-the-subtyping-model" class="section level2">
<h2 class="hasAnchor">
<a href="#train-the-subtyping-model" class="anchor"></a>Train the subtyping model</h2>
<p>We use a four group model here in order to demonstrate the difference from the known three group diagnosis.</p>
<pre class="{r}"><code>qdf = trainSubtypeUni( mydf, "cognition_adjusted", c("C0","C1","C2","C3"), c(0.25,0.5, 0.75) )</code></pre>
</div>
<div id="perform-inference-with-the-subtyping-model" class="section level2">
<h2 class="hasAnchor">
<a href="#perform-inference-with-the-subtyping-model" class="anchor"></a>Perform inference with the subtyping model</h2>
<p>We define the subtype from the baseline data. This means that we assume that the data at baseline is sufficient to confidently identify which grouping to which the subject should belong.</p>
<pre class="{r}"><code>pdf = predictSubtypeUni( mydf, qdf, "Id", "visit", "V0" )</code></pre>
</div>
<div id="check-subtypes-against-diagnosis" class="section level2">
<h2 class="hasAnchor">
<a href="#check-subtypes-against-diagnosis" class="anchor"></a>Check subtypes against diagnosis</h2>
<p>Data-driven subtypes should overlap — in our simulated data example — with diagnosis.</p>
<pre class="{r}"><code><a href="https://rdrr.io/pkg/knitr/man/kable.html">knitr::kable( table( pdf$subtype, mydf$DX ), caption='Subtypes vs diagnosis: By design, these categories are very similar.', table.attr = "style='width:60%;'")</a></code></pre>
</div>
<div id="visualize-the-results" class="section level2">
<h2 class="hasAnchor">
<a href="#visualize-the-results" class="anchor"></a>Visualize the results</h2>
<p>See the difference with diagnosis.</p>
<pre class="{r}"><code>summ = plotSubtypeChange( mydf, "Id", "cognition", "DX", "visit", whiskervar='se'  )</code></pre>
<p>See the difference with subtype.</p>
<pre class="{r}"><code>summ = plotSubtypeChange( pdf, "Id", "cognition", "subtype", "visit", whiskervar='se' )</code></pre>
<p>Visualization of the subtype definition against various outcomes is key to establishing validity.</p>
</div>
<div id="installing" class="section level2">
<h2 class="hasAnchor">
<a href="#installing" class="anchor"></a>Installing</h2>
<p>The pre-release version of the package can be pulled from GitHub using the <a href="https://github.com/r-lib/devtools">devtools</a> package:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode R"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="co"># install.packages("devtools")</span></a>
<a class="sourceLine" id="cb12-2" data-line-number="2">devtools<span class="op">::</span><span class="kw">install_github</span>(<span class="st">"stnava/subtyper"</span>, <span class="dt">build_vignettes=</span><span class="ot">TRUE</span>)</a></code></pre></div>
</div>
<div id="for-developers" class="section level2">
<h2 class="hasAnchor">
<a href="#for-developers" class="anchor"></a>For developers</h2>
<p>The repository includes a Makefile to facilitate some common tasks.</p>
<div id="running-tests" class="section level3">
<h3 class="hasAnchor">
<a href="#running-tests" class="anchor"></a>Running tests</h3>
<p><code>$ make test</code>. Requires the <a href="http://testthat.r-lib.org/">testthat</a> package. You can also specify a specific test file or files to run by adding a “file=” argument, like <code>$ make test file=logging</code>. <code><a href="https://testthat.r-lib.org/reference/test_package.html">testthat::test_package()</a></code> will do a regular-expression pattern match within the file names (ignoring the <code>test-</code> prefix and the <code>.R</code> file extension).</p>
</div>
<div id="updating-documentation" class="section level3">
<h3 class="hasAnchor">
<a href="#updating-documentation" class="anchor"></a>Updating documentation</h3>
<p><code>$ make doc</code>. Requires the <a href="https://github.com/klutometis/roxygen">roxygen2</a> package.</p>
</div>
</div>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://github.com/stnava/subtyper/">https://​github.com/​stnava/​subtyper/​</a>
</li>
<li>Report a bug at <br><a href="https://github.com/stnava/subtyper/issues">https://​github.com/​stnava/​subtyper/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Brian B. Avants <br><small class="roles"> Author, maintainer </small>  </li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://travis-ci.org/stnava/subtyper"><img src="https://travis-ci.org/stnava/subtyper.png?branch=master" alt="Build Status"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Brian B. Avants.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
