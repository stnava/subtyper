<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>subtyper: basic example explained • subtyper</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="subtyper: basic example explained">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">subtyper</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/subtyper.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/nalls_pd_genetics.html">subtyper: subtyping with functional enrichment via SNPs</a>
    </li>
    <li>
      <a href="../articles/pd_imaging_genetics.html">subtyper: ppmi subtyping with functional enrichment via SNPs</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/stnava/subtyper/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>subtyper: basic example explained</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/stnava/subtyper/blob/HEAD/vignettes/subtyper.Rmd" class="external-link"><code>vignettes/subtyper.Rmd</code></a></small>
      <div class="hidden name"><code>subtyper.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="overview-of-subtyper">Overview of <code>subtyper</code><a class="anchor" aria-label="anchor" href="#overview-of-subtyper"></a>
</h2>
<p>Subtyper is a package for defining subtypes in patient populations
based on data. A “subtyping method” uses data to classify subjects into
groups that represent different disease etiologies, different
progression paths or different sets of symptoms potentially arising from
the same underlying pathology. Subtyping therefore tries to identify
smaller but distinctive groups within an overall disorder. If the
overall condition is dementia, then diagnoses could be considered as
subtypes: Alzheimer’s disease, parkinson’s disease or frontotemporal
lobar degeneration.</p>
<p>Subtyping methods must be predictive. That is, they follow a machine
learning style with a “training” phase for the models followed by
inference wherein we apply the fixed models to new data. Subtyper’s
design follows this paradigm which will be seen in the examples below.
While we only use linear regression here, the basic principles can
extend to other modeling techniques including deep learning.</p>
<p>Subtyping and “staging” are or may be inter-related. For example,
some sub-types may only be identifiable at a given disease stage. Other
subtypes are fundamentally different across all disease stages
(e.g. genetic forms of AD or PD vs idiopathic forms). In PD, some
patients “jump” between classically defined subtypes (see 2021 Lancet
review on PD diagnosis). Ths package does not claim to produce “good”
subtypes. It’s just a tool that allows one to test and visualize
different approaches to subtyping whether they are stage-specific or
not.</p>
<div class="section level3">
<h3 id="generic-processing-steps">Generic processing steps<a class="anchor" aria-label="anchor" href="#generic-processing-steps"></a>
</h3>
<p>The brief code block below shows us the core steps in
<code>subtyper</code>. We will comment on each step within its own
section.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/stnava/subtyper" class="external-link">subtyper</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: replacing previous import 'ciTools::add_ci' by 'gtsummary::add_ci'</span></span>
<span><span class="co">#&gt; when loading 'subtyper'</span></span>
<span><span class="co">#&gt; Warning: replacing previous import 'dplyr::as_data_frame' by</span></span>
<span><span class="co">#&gt; 'igraph::as_data_frame' when loading 'subtyper'</span></span>
<span><span class="co">#&gt; Warning: replacing previous import 'dplyr::groups' by 'igraph::groups' when</span></span>
<span><span class="co">#&gt; loading 'subtyper'</span></span>
<span><span class="co">#&gt; Warning: replacing previous import 'dplyr::union' by 'igraph::union' when</span></span>
<span><span class="co">#&gt; loading 'subtyper'</span></span>
<span><span class="co">#&gt; Warning: replacing previous import 'gtsummary::add_ci' by 'ciTools::add_ci'</span></span>
<span><span class="co">#&gt; when loading 'subtyper'</span></span>
<span><span class="co">#&gt; Registered S3 methods overwritten by 'fmsb':</span></span>
<span><span class="co">#&gt;   method    from</span></span>
<span><span class="co">#&gt;   print.roc pROC</span></span>
<span><span class="co">#&gt;   plot.roc  pROC</span></span>
<span><span class="co">#&gt; Warning: replacing previous import 'gt::gt' by 'globaltest::gt' when loading</span></span>
<span><span class="co">#&gt; 'subtyper'</span></span>
<span><span class="co">#&gt; Warning: replacing previous import 'dplyr::rename' by 'plyr::rename' when</span></span>
<span><span class="co">#&gt; loading 'subtyper'</span></span>
<span><span class="va">mydf</span> <span class="op">=</span> <span class="fu"><a href="../reference/generateSubtyperData.html">generateSubtyperData</a></span><span class="op">(</span> <span class="fl">100</span> <span class="op">)</span></span>
<span><span class="va">rbfnames</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">mydf</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"Random"</span>,<span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">mydf</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">mydf</span> <span class="op">=</span> <span class="fu"><a href="../reference/outlierness.html">outlierness</a></span><span class="op">(</span> <span class="va">mydf</span>, <span class="va">rbfnames</span> <span class="op">)</span></span>
<span><span class="co">#&gt; [1] "r update: 2"</span></span>
<span><span class="co">#&gt; [1] "r update: 3"</span></span>
<span><span class="co">#&gt; [1] "r update: 4"</span></span>
<span><span class="co">#&gt; [1] "r update: 5"</span></span>
<span><span class="co">#&gt; [1] "r update: 6"</span></span>
<span><span class="va">mydf</span> <span class="op">=</span> <span class="fu"><a href="../reference/highestQualityRepeat.html">highestQualityRepeat</a></span><span class="op">(</span> <span class="va">mydf</span>, <span class="st">"Id"</span>, <span class="st">"visit"</span>, <span class="st">"OL_KNN_SUM"</span><span class="op">)</span></span>
<span><span class="va">qdf</span> <span class="op">=</span> <span class="fu"><a href="../reference/trainSubtypeUni.html">trainSubtypeUni</a></span><span class="op">(</span> <span class="va">mydf</span>, <span class="st">"cognition"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"C0"</span>,<span class="st">"C1"</span>,<span class="st">"C2"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.33</span>,<span class="fl">0.66</span><span class="op">)</span> <span class="op">)</span></span>
<span><span class="va">pdf</span> <span class="op">=</span> <span class="fu"><a href="../reference/predictSubtypeUni.html">predictSubtypeUni</a></span><span class="op">(</span> <span class="va">mydf</span>, <span class="va">qdf</span>, <span class="st">"Id"</span> <span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="example-data">Example data<a class="anchor" aria-label="anchor" href="#example-data"></a>
</h3>
<p>The function:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n</span> <span class="op">=</span> <span class="fl">250</span> <span class="co"># number of subjects</span></span>
<span><span class="va">mydf</span> <span class="op">=</span> <span class="fu"><a href="../reference/generateSubtyperData.html">generateSubtyperData</a></span><span class="op">(</span> <span class="va">n</span> <span class="op">)</span></span></code></pre></div>
<p>simply supplies a dataframe that fits our assumptions about how data
is organized.</p>
<ul>
<li><p>subject IDs are provided</p></li>
<li><p>each subject has one or more “visits”</p></li>
<li><p>at each visit, there may be more than one repeats of a
measurement</p></li>
<li><p>there is some measurement of the quality of each measurement
(optional)</p></li>
</ul>
<p>While our simulated data is complete, in reality, many subjects may
be missing data. We can further simulate this (at random) by
performing:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nrows</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span> <span class="va">mydf</span> <span class="op">)</span></span>
<span><span class="va">mixna</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">nrows</span>,<span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">mydf</span><span class="op">[</span> <span class="va">mixna</span>, <span class="st">"cognition"</span> <span class="op">]</span> <span class="op">=</span> <span class="cn">NA</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="outlierness">Outlierness<a class="anchor" aria-label="anchor" href="#outlierness"></a>
</h3>
<p>It is important to note that these methods are likely to be more
generalizable if they are trained and applied to data that is “good”
quality. While we assume that the data comes with some quality
measurements (domain specific), we may also use data-driven approaches
to measuring how close each timepoint-repeat is to related data. If such
a datapoint is “far away” from its nearest neighbors, then it is likely
to be an outlier. The <code>outlierness</code> function implements
several methods for making such estimations which can guide data
inspection.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rbfnames</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">mydf</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"Random"</span>,<span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">mydf</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">mydf</span> <span class="op">=</span> <span class="fu"><a href="../reference/outlierness.html">outlierness</a></span><span class="op">(</span> <span class="va">mydf</span>, <span class="va">rbfnames</span> <span class="op">)</span></span></code></pre></div>
<p>These outlierness measurements are added to the data frame by the
above call. The names are prepended with “OL_”. Which particular
measurement – or set of measurements – is best may depend on your
dataset.</p>
<p><strong>Warning:</strong> Some subjects will always be outliers
according to these methods. However, that does not mean they should be
rejected. Decisions about data rejection should be put off to the last
possible moment. Another option is to simply covary for the outlierness
score — with the assumption that the score is not or is only marginally
related to the outcomes of interest.</p>
</div>
<div class="section level3">
<h3 id="filter-for-quality">Filter for quality<a class="anchor" aria-label="anchor" href="#filter-for-quality"></a>
</h3>
<p>Given the above comments, we might want to find the “best” repeat for
each time point in the case when there are multiple repeats. Here, we
use the <code>OL_KNN_SUM</code> score as an outlierness measurement.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mydf</span> <span class="op">=</span> <span class="fu"><a href="../reference/highestQualityRepeat.html">highestQualityRepeat</a></span><span class="op">(</span> <span class="va">mydf</span>, <span class="st">"Id"</span>, <span class="st">"visit"</span>, <span class="st">"OL_KNN_SUM"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="covariate-adjustment">Covariate adjustment<a class="anchor" aria-label="anchor" href="#covariate-adjustment"></a>
</h3>
<p>The function <code>adjustByCovariates</code> can be used to train and
predict covariate adjusted scores. Here, we train the adjustment based
on group <code>G0</code> and adjust with respect to
<code>RandomBasisProjection01</code>. In practice, these variables may
include age, sex and other nuisance variables.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">myform</span> <span class="op">=</span> <span class="st">"cognition ~ RandomBasisProjection01 "</span></span>
<span><span class="va">mydf</span> <span class="op">=</span> <span class="fu"><a href="../reference/adjustByCovariates.html">adjustByCovariates</a></span><span class="op">(</span><span class="va">mydf</span>,<span class="va">myform</span>,<span class="st">"DX"</span>,<span class="st">"G0"</span><span class="op">)</span></span>
<span><span class="co"># produces a variable called cognition_adjusted</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="train-the-subtyping-model">Train the subtyping model<a class="anchor" aria-label="anchor" href="#train-the-subtyping-model"></a>
</h3>
<p>We employ a three group model as it matches our known (simulated)
diagnostic groups. Otherwise, we could use a four group model here in
order to demonstrate the difference from the known three group
diagnosis.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># four group model</span></span>
<span><span class="va">qdf4</span> <span class="op">=</span> <span class="fu"><a href="../reference/trainSubtypeUni.html">trainSubtypeUni</a></span><span class="op">(</span> <span class="va">mydf</span>, <span class="st">"cognition_adjusted"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"C0"</span>,<span class="st">"C1"</span>,<span class="st">"C2"</span>,<span class="st">"C3"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.25</span>,<span class="fl">0.5</span>, <span class="fl">0.75</span><span class="op">)</span> <span class="op">)</span></span>
<span><span class="co"># three group model</span></span>
<span><span class="va">qdf</span> <span class="op">=</span> <span class="fu"><a href="../reference/trainSubtypeUni.html">trainSubtypeUni</a></span><span class="op">(</span> <span class="va">mydf</span>, <span class="st">"cognition_adjusted"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"C0"</span>,<span class="st">"C1"</span>,<span class="st">"C2"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">0.33</span>, <span class="fl">0.66</span> <span class="op">)</span> <span class="op">)</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span> <span class="va">qdf</span>, caption<span class="op">=</span><span class="st">"Subtyping training result."</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Subtyping training result.</caption>
<thead><tr class="header">
<th align="left">subtype</th>
<th align="left">measurement</th>
<th align="right">quantiles</th>
<th align="right">quantileValues</th>
<th align="left">group</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">C0</td>
<td align="left">cognition_adjusted</td>
<td align="right">0.00</td>
<td align="right">-Inf</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">C1</td>
<td align="left">cognition_adjusted</td>
<td align="right">0.33</td>
<td align="right">1.862423</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">C2</td>
<td align="left">cognition_adjusted</td>
<td align="right">0.66</td>
<td align="right">4.538340</td>
<td align="left">NA</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="perform-inference-with-the-subtyping-model">Perform inference with the subtyping model<a class="anchor" aria-label="anchor" href="#perform-inference-with-the-subtyping-model"></a>
</h3>
<p>We define the subtype from the baseline data. This means that we
assume that the data at baseline is sufficient to confidently identify
which grouping to which the subject should belong.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pdf</span> <span class="op">=</span> <span class="fu"><a href="../reference/predictSubtypeUni.html">predictSubtypeUni</a></span><span class="op">(</span> <span class="va">mydf</span>, <span class="va">qdf</span>, <span class="st">"Id"</span>, <span class="st">"visit"</span>, <span class="st">"V0"</span> <span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="check-subtypes-against-diagnosis">Check subtypes against diagnosis<a class="anchor" aria-label="anchor" href="#check-subtypes-against-diagnosis"></a>
</h3>
<p>Data-driven subtypes should overlap — in our simulated data example —
with diagnosis.</p>
<table class="table">
<caption>Subtypes vs diagnosis: By design, these categories are very
similar.</caption>
<thead><tr class="header">
<th align="left"></th>
<th align="right">G0</th>
<th align="right">G1</th>
<th align="right">G2</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">C0</td>
<td align="right">13</td>
<td align="right">8</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">C1</td>
<td align="right">5</td>
<td align="right">11</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">C2</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">18</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="visualize-the-results">Visualize the results<a class="anchor" aria-label="anchor" href="#visualize-the-results"></a>
</h3>
<p>See the difference with diagnosis.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">summ</span> <span class="op">=</span> <span class="fu"><a href="../reference/plotSubtypeChange.html">plotSubtypeChange</a></span><span class="op">(</span> <span class="va">mydf</span>, <span class="st">"Id"</span>, <span class="st">"cognition"</span>, <span class="st">"DX"</span>, <span class="st">"visit"</span>, whiskervar<span class="op">=</span><span class="st">'se'</span>  <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span> <span class="va">summ</span> <span class="op">)</span></span></code></pre></div>
<p><img src="subtyper_files/figure-html/plotit-1.png" width="768"></p>
<p>See the difference with subtype.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">summ</span> <span class="op">=</span> <span class="fu"><a href="../reference/plotSubtypeChange.html">plotSubtypeChange</a></span><span class="op">(</span> <span class="va">pdf</span>, <span class="st">"Id"</span>, <span class="st">"cognition"</span>, <span class="st">"subtype"</span>, <span class="st">"visit"</span>, whiskervar<span class="op">=</span><span class="st">'se'</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span> <span class="va">summ</span> <span class="op">)</span></span></code></pre></div>
<p><img src="subtyper_files/figure-html/plotit2-1.png" width="768"></p>
<p>Plot the subtypes with cutpoints displayed.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pdf</span> <span class="op">=</span> <span class="fu"><a href="../reference/predictSubtypeUni.html">predictSubtypeUni</a></span><span class="op">(</span> <span class="va">mydf</span>, <span class="va">qdf</span>, <span class="st">"Id"</span>, <span class="st">"visit"</span>, <span class="st">"V0"</span>, rename<span class="op">=</span><span class="cn">FALSE</span> <span class="op">)</span></span>
<span><span class="va">summ</span> <span class="op">=</span> <span class="fu"><a href="../reference/plotSubtypeChange.html">plotSubtypeChange</a></span><span class="op">(</span> <span class="va">pdf</span>, <span class="st">"Id"</span>, <span class="st">"cognition"</span>, <span class="st">"subtype"</span>, <span class="st">"visit"</span>, whiskervar<span class="op">=</span><span class="st">'se'</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span> <span class="va">summ</span> <span class="op">)</span></span></code></pre></div>
<p><img src="subtyper_files/figure-html/plotit3-1.png" width="768"></p>
<p>Visualization of the subtype definition against various outcomes is
key to establishing validity.</p>
</div>
<div class="section level3">
<h3 id="biclustering">Biclustering<a class="anchor" aria-label="anchor" href="#biclustering"></a>
</h3>
<p>We implement a simple biclustering method based on matrix
factorization.</p>
<p><img src="subtyper_files/figure-html/nmfbi-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="consensus-clustering-example">consensus clustering example<a class="anchor" aria-label="anchor" href="#consensus-clustering-example"></a>
</h3>
<p>Generate some data, as above. Define the feature columns and the
clustering methods to test.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/stnava/subtyper" class="external-link">subtyper</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span> <span class="va"><a href="http://github.com/acabassi/coca" class="external-link">coca</a></span> <span class="op">)</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">data</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>,</span>
<span>                      <span class="st">"dataset1.csv"</span>, package <span class="op">=</span> <span class="st">"coca"</span><span class="op">)</span>, row.names <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">data</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>,</span>
<span>                      <span class="st">"dataset2.csv"</span>, package <span class="op">=</span> <span class="st">"coca"</span><span class="op">)</span>, row.names <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">data</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>,</span>
<span>                      <span class="st">"dataset3.csv"</span>, package <span class="op">=</span> <span class="st">"coca"</span><span class="op">)</span>, row.names <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">bounded</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span> <span class="va">data</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="va">data</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>, <span class="va">data</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span> <span class="op">)</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span> <span class="va">bounded</span> <span class="op">)</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"XDAT"</span>,<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">bounded</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">### generate data</span></span>
<span><span class="va">mydf</span> <span class="op">=</span> <span class="fu"><a href="../reference/generateSubtyperData.html">generateSubtyperData</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">bounded</span><span class="op">)</span> <span class="op">)</span></span>
<span><span class="va">mydf</span><span class="op">$</span><span class="va">Id</span> <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">mydf</span><span class="op">)</span></span>
<span><span class="va">mydf</span><span class="op">$</span><span class="va">visit</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"V0"</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">mydf</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">mydf</span><span class="op">$</span><span class="va">repeater</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"V0"</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">mydf</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">mydf</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span> <span class="va">mydf</span>, <span class="va">bounded</span> <span class="op">)</span></span>
<span><span class="va">clustlist</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> </span>
<span>    <span class="st">"clust.cmeans"</span>, <span class="st">"flexcorr"</span>, <span class="st">"flexcanb"</span>, <span class="st">"flexmink"</span>, <span class="st">"GMM"</span>,  <span class="st">"pamCluster"</span>, </span>
<span>    <span class="st">"kmedians"</span>, <span class="st">"angle"</span>, <span class="st">"ejaccard"</span>, <span class="st">"hardcl"</span>,  <span class="st">"cckmeans"</span> <span class="op">)</span></span>
<span><span class="va">fnames</span> <span class="op">=</span> <span class="fu"><a href="../reference/getNamesFromDataframe.html">getNamesFromDataframe</a></span><span class="op">(</span> <span class="st">"XDAT"</span>, <span class="va">mydf</span> <span class="op">)</span></span>
<span><span class="co"># induce some clustering structure</span></span></code></pre></div>
<p>Next, we use subtyper methods to generate clustering solutions. We
train from the baseline visit.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mvcl</span><span class="op">=</span><span class="st">'MVST'</span> <span class="co"># default prefix - can be changed</span></span>
<span><span class="va">cohortbl</span> <span class="op">=</span> <span class="va">mydf</span><span class="op">[</span> <span class="va">mydf</span><span class="op">$</span><span class="va">visit</span> <span class="op">==</span> <span class="st">'V0'</span>, <span class="op">]</span></span>
<span><span class="va">mydf</span> <span class="op">=</span> <span class="fu"><a href="../reference/consensusSubtypingPrep.html">consensusSubtypingPrep</a></span><span class="op">(</span> <span class="va">cohortbl</span>, <span class="va">mydf</span>, <span class="va">fnames</span>,</span>
<span>  <span class="va">clustlist</span>, maxK<span class="op">=</span><span class="fl">6</span>,</span>
<span>  <span class="va">fnames</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, mvcl<span class="op">=</span><span class="va">mvcl</span>, verbose<span class="op">=</span><span class="cn">FALSE</span> <span class="op">)</span></span></code></pre></div>
<p>Given the full output, run a consensus method.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># some hidden function cannot be found if we dont explicitly load caret</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span> <span class="va"><a href="https://github.com/topepo/caret/" class="external-link">caret</a></span> <span class="op">)</span> </span>
<span><span class="co">#&gt; Loading required package: ggplot2</span></span>
<span><span class="co">#&gt; Warning: package 'ggplot2' was built under R version 4.3.1</span></span>
<span><span class="co">#&gt; Loading required package: lattice</span></span>
<span><span class="co">#&gt; Warning: package 'lattice' was built under R version 4.3.1</span></span>
<span><span class="va">ccname</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">mvcl</span>,<span class="st">"_CC"</span><span class="op">)</span></span>
<span><span class="va">cocanames</span> <span class="op">=</span> <span class="fu"><a href="../reference/getNamesFromDataframe.html">getNamesFromDataframe</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">mvcl</span>,<span class="st">"_cstk"</span><span class="op">)</span>, <span class="va">mydf</span>, exclusions<span class="op">=</span><span class="st">'_mem'</span><span class="op">)</span></span>
<span><span class="va">maxK</span> <span class="op">=</span> <span class="fl">6</span></span>
<span><span class="va">myoh</span> <span class="op">=</span> <span class="va">clustdata</span> <span class="op">=</span> <span class="fu"><a href="../reference/consensusSubtypingCOCA.html">consensusSubtypingCOCA</a></span><span class="op">(</span> <span class="va">mydf</span>, maxK<span class="op">=</span><span class="va">maxK</span>, </span>
<span>  cocanames<span class="op">=</span><span class="va">cocanames</span>,</span>
<span>  newclustername<span class="op">=</span><span class="va">ccname</span>, </span>
<span>  idvar<span class="op">=</span><span class="st">'Id'</span>, visitName<span class="op">=</span><span class="st">'visit'</span>, </span>
<span>  baselineVisit<span class="op">=</span><span class="st">'V0'</span>, </span>
<span>  binnmf<span class="op">=</span><span class="fl">2</span>,</span>
<span>  returnonehot<span class="op">=</span><span class="cn">TRUE</span> <span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; MVST_cstk_2_cckmeans1 MVST_cstk_2_cckmeans2 </span></span>
<span><span class="co">#&gt;                    75                    50 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; MVST_cstk_2_hardcl1 MVST_cstk_2_hardcl2 </span></span>
<span><span class="co">#&gt;                  51                  74 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; MVST_cstk_3_flexcanb1 MVST_cstk_3_flexcanb2 MVST_cstk_3_flexcanb3 </span></span>
<span><span class="co">#&gt;                    25                    50                    50 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; MVST_cstk_3_GMM1 MVST_cstk_3_GMM2 MVST_cstk_3_GMM3 </span></span>
<span><span class="co">#&gt;               50               25               50 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; MVST_cstk_4_hardcl1 MVST_cstk_4_hardcl2 MVST_cstk_4_hardcl3 MVST_cstk_4_hardcl4 </span></span>
<span><span class="co">#&gt;                  25                  25                  26                  49 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; MVST_cstk_4_cckmeans1 MVST_cstk_4_cckmeans2 MVST_cstk_4_cckmeans3 </span></span>
<span><span class="co">#&gt;                    50                    13                    13 </span></span>
<span><span class="co">#&gt; MVST_cstk_4_cckmeans4 </span></span>
<span><span class="co">#&gt;                    49 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; MVST_cstk_5_kmedians1 MVST_cstk_5_kmedians2 MVST_cstk_5_kmedians3 </span></span>
<span><span class="co">#&gt;                    25                    25                    25 </span></span>
<span><span class="co">#&gt; MVST_cstk_5_kmedians4 MVST_cstk_5_kmedians5 </span></span>
<span><span class="co">#&gt;                    25                    25 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; MVST_cstk_5_cckmeans1 MVST_cstk_5_cckmeans2 MVST_cstk_5_cckmeans3 </span></span>
<span><span class="co">#&gt;                    50                    14                    11 </span></span>
<span><span class="co">#&gt; MVST_cstk_5_cckmeans4 MVST_cstk_5_cckmeans5 </span></span>
<span><span class="co">#&gt;                    25                    25 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; MVST_cstk_6_flexmink1 MVST_cstk_6_flexmink2 MVST_cstk_6_flexmink3 </span></span>
<span><span class="co">#&gt;                    25                    10                    15 </span></span>
<span><span class="co">#&gt; MVST_cstk_6_flexmink4 MVST_cstk_6_flexmink5 MVST_cstk_6_flexmink6 </span></span>
<span><span class="co">#&gt;                    25                    25                    25 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; MVST_cstk_6_pamCluster1 MVST_cstk_6_pamCluster2 MVST_cstk_6_pamCluster3 </span></span>
<span><span class="co">#&gt;                      25                      25                      13 </span></span>
<span><span class="co">#&gt; MVST_cstk_6_pamCluster4 MVST_cstk_6_pamCluster5 MVST_cstk_6_pamCluster6 </span></span>
<span><span class="co">#&gt;                      12                      25                      25 </span></span>
<span><span class="co">#&gt; [1] "nmfbin done"</span></span>
<span><span class="fu">pheatmap</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pheatmap/man/pheatmap.html" class="external-link">pheatmap</a></span><span class="op">(</span> <span class="va">myoh</span> <span class="op">)</span></span></code></pre></div>
<p><img src="subtyper_files/figure-html/consensusclustermodel-1.png" width="700"></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">clustdata</span> <span class="op">=</span> <span class="fu"><a href="../reference/consensusSubtypingCOCA.html">consensusSubtypingCOCA</a></span><span class="op">(</span> <span class="va">mydf</span>, maxK<span class="op">=</span><span class="va">maxK</span>, </span>
<span>  cocanames<span class="op">=</span><span class="va">cocanames</span>,</span>
<span>  newclustername<span class="op">=</span><span class="va">ccname</span>, </span>
<span>  idvar<span class="op">=</span><span class="st">'Id'</span>, visitName<span class="op">=</span><span class="st">'visit'</span>, baselineVisit<span class="op">=</span><span class="st">'V0'</span>, </span>
<span>  binnmf<span class="op">=</span><span class="fl">2</span>,</span>
<span>  verbose<span class="op">=</span><span class="cn">TRUE</span> <span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; MVST_cstk_2_cckmeans1 MVST_cstk_2_cckmeans2 </span></span>
<span><span class="co">#&gt;                    75                    50 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; MVST_cstk_2_hardcl1 MVST_cstk_2_hardcl2 </span></span>
<span><span class="co">#&gt;                  51                  74 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; MVST_cstk_3_flexcanb1 MVST_cstk_3_flexcanb2 MVST_cstk_3_flexcanb3 </span></span>
<span><span class="co">#&gt;                    25                    50                    50 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; MVST_cstk_3_GMM1 MVST_cstk_3_GMM2 MVST_cstk_3_GMM3 </span></span>
<span><span class="co">#&gt;               50               25               50 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; MVST_cstk_4_hardcl1 MVST_cstk_4_hardcl2 MVST_cstk_4_hardcl3 MVST_cstk_4_hardcl4 </span></span>
<span><span class="co">#&gt;                  25                  25                  26                  49 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; MVST_cstk_4_cckmeans1 MVST_cstk_4_cckmeans2 MVST_cstk_4_cckmeans3 </span></span>
<span><span class="co">#&gt;                    50                    13                    13 </span></span>
<span><span class="co">#&gt; MVST_cstk_4_cckmeans4 </span></span>
<span><span class="co">#&gt;                    49 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; MVST_cstk_5_kmedians1 MVST_cstk_5_kmedians2 MVST_cstk_5_kmedians3 </span></span>
<span><span class="co">#&gt;                    25                    25                    25 </span></span>
<span><span class="co">#&gt; MVST_cstk_5_kmedians4 MVST_cstk_5_kmedians5 </span></span>
<span><span class="co">#&gt;                    25                    25 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; MVST_cstk_5_cckmeans1 MVST_cstk_5_cckmeans2 MVST_cstk_5_cckmeans3 </span></span>
<span><span class="co">#&gt;                    50                    14                    11 </span></span>
<span><span class="co">#&gt; MVST_cstk_5_cckmeans4 MVST_cstk_5_cckmeans5 </span></span>
<span><span class="co">#&gt;                    25                    25 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; MVST_cstk_6_flexmink1 MVST_cstk_6_flexmink2 MVST_cstk_6_flexmink3 </span></span>
<span><span class="co">#&gt;                    25                    10                    15 </span></span>
<span><span class="co">#&gt; MVST_cstk_6_flexmink4 MVST_cstk_6_flexmink5 MVST_cstk_6_flexmink6 </span></span>
<span><span class="co">#&gt;                    25                    25                    25 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; MVST_cstk_6_pamCluster1 MVST_cstk_6_pamCluster2 MVST_cstk_6_pamCluster3 </span></span>
<span><span class="co">#&gt;                      25                      25                      13 </span></span>
<span><span class="co">#&gt; MVST_cstk_6_pamCluster4 MVST_cstk_6_pamCluster5 MVST_cstk_6_pamCluster6 </span></span>
<span><span class="co">#&gt;                      12                      25                      25 </span></span>
<span><span class="co">#&gt; [1] "nmfbin done"</span></span>
<span><span class="co">#&gt; kmeans spearman 6</span></span>
<span><span class="co">#&gt; COCA complete</span></span>
<span><span class="co">#&gt; cocatxlab</span></span>
<span><span class="co">#&gt;  1  2  3 </span></span>
<span><span class="co">#&gt; 25 75 25</span></span></code></pre></div>
<p>Compare the new clustering to the originals.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">for</span> <span class="op">(</span> <span class="va">k</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">cocanames</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span> <span class="va">cocanames</span><span class="op">[</span><span class="va">k</span><span class="op">]</span>, </span>
<span>    <span class="fu">mclust</span><span class="fu">::</span><span class="fu"><a href="https://mclust-org.github.io/mclust/reference/adjustedRandIndex.html" class="external-link">adjustedRandIndex</a></span><span class="op">(</span><span class="va">clustdata</span><span class="op">[</span>,<span class="va">cocanames</span><span class="op">[</span><span class="va">k</span><span class="op">]</span><span class="op">]</span>, <span class="va">clustdata</span><span class="op">[</span>,<span class="va">ccname</span><span class="op">]</span><span class="op">)</span> <span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; [1] "MVST_cstk_2_cckmeans 0.196891191709845"</span></span>
<span><span class="co">#&gt; [1] "MVST_cstk_2_hardcl 0.190078736237752"</span></span>
<span><span class="co">#&gt; [1] "MVST_cstk_3_flexcanb 0.497297297297297"</span></span>
<span><span class="co">#&gt; [1] "MVST_cstk_3_GMM 0.162162162162162"</span></span>
<span><span class="co">#&gt; [1] "MVST_cstk_4_hardcl 0.321466172398234"</span></span>
<span><span class="co">#&gt; [1] "MVST_cstk_4_cckmeans 0.117933358292774"</span></span>
<span><span class="co">#&gt; [1] "MVST_cstk_5_kmedians 0.474576271186441"</span></span>
<span><span class="co">#&gt; [1] "MVST_cstk_5_cckmeans 0.268734056831009"</span></span>
<span><span class="co">#&gt; [1] "MVST_cstk_6_flexmink 0.429447852760736"</span></span>
<span><span class="co">#&gt; [1] "MVST_cstk_6_pamCluster 0.427632476068399"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span> <span class="va">clustdata</span><span class="op">[</span>,<span class="va">cocanames</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="va">clustdata</span><span class="op">[</span>,<span class="va">ccname</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;                        </span></span>
<span><span class="co">#&gt;                         MVST_CC1 MVST_CC2 MVST_CC3</span></span>
<span><span class="co">#&gt;   MVST_cstk_2_cckmeans1       25       50        0</span></span>
<span><span class="co">#&gt;   MVST_cstk_2_cckmeans2        0       25       25</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span> <span class="va">clustdata</span><span class="op">[</span>,<span class="va">cocanames</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>, <span class="va">clustdata</span><span class="op">[</span>,<span class="va">ccname</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;                      </span></span>
<span><span class="co">#&gt;                       MVST_CC1 MVST_CC2 MVST_CC3</span></span>
<span><span class="co">#&gt;   MVST_cstk_2_hardcl1       25       26        0</span></span>
<span><span class="co">#&gt;   MVST_cstk_2_hardcl2        0       49       25</span></span></code></pre></div>
<p>There you have it.</p>
</div>
<div class="section level3">
<h3 id="future-work">Future work<a class="anchor" aria-label="anchor" href="#future-work"></a>
</h3>
<p>The package will evolve with the associated needs of related
projects.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Brian Avants.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
