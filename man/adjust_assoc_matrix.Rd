% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/subtyper.R
\name{adjust_assoc_matrix}
\alias{adjust_assoc_matrix}
\title{Adjust association matrix for global correlation structure}
\usage{
adjust_assoc_matrix(
  assoc_mat,
  method = c("none", "row_normalize", "col_normalize", "both_normalize", "pc1_regress",
    "glasso"),
  lambda = 0.1,
  return_scores = FALSE
)
}
\arguments{
\item{assoc_mat}{A numeric matrix of size (features × domains).}

\item{method}{A character string specifying adjustment method.
Options:
- "none" (raw associations)
- "row_normalize" (z-score across rows)
- "col_normalize" (z-score across columns)
- "both_normalize" (z-score rows and columns)
- "pc1_regress" (remove 1st principal component effect)
- "glasso" (apply graphical lasso for partial correlations).}

\item{lambda}{Numeric penalty parameter for glasso (only used if method="glasso").}

\item{return_scores}{Logical; if TRUE, return the full adjusted score matrix.
If FALSE, return only best assignments per feature.}
}
\value{
If return_scores=FALSE, a character vector of assigned domains
(one per feature). If TRUE, a list with:
- adjusted_matrix: the adjusted score matrix
- assignments: best-matching domain per feature
}
\description{
This function takes a feature × domain association matrix and applies
different methods to control for global/shared correlation structure
(e.g., some features are globally correlated with all domains).
It then provides domain assignments based on the adjusted scores.
}
\examples{
set.seed(1)
mat <- matrix(rnorm(50), nrow=5, ncol=10)
rownames(mat) <- paste0("Feature", 1:5)
colnames(mat) <- paste0("Domain", 1:10)
adjust_assoc_matrix(mat, method="row_normalize")

}
