% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/subtyper.R
\name{harmonize_sites_quantiles}
\alias{harmonize_sites_quantiles}
\title{Harmonize Multiple Features Across Sites with Quantile Matching}
\usage{
harmonize_sites_quantiles(
  data,
  site_col,
  diagnosis_col,
  control_label,
  feature_cols,
  reference_site
)
}
\arguments{
\item{data}{A data frame containing the data.}

\item{site_col}{A string indicating the column name for site identifiers.}

\item{diagnosis_col}{A string indicating the column name for diagnosis identifiers.}

\item{control_label}{The label in the diagnosis column identifying the control group.}

\item{feature_cols}{A vector of strings specifying the feature columns to be harmonized.}

\item{reference_site}{The site identifier to use as the reference site for control quantiles.}
}
\value{
A list containing:
\itemize{
\item \code{harmonized_data}: the data frame with features adjusted across sites.
\item \code{summary_stats}: a data frame with quantiles (e.g., 25th, 50th, and 75th) by site for each feature.
}
}
\description{
Adjusts specified features across sites to match the quantiles (e.g., 25th, 50th, and 75th) of the control group
in the reference site. The transformation is applied to all data within each site, regardless of diagnosis, for each feature separately.
}
\examples{
harmonize_sites_quantiles(df, site_col = "Site", diagnosis_col = "Diagnosis", 
                          control_label = "Control", feature_cols = c("Feature1", "Feature2"), 
                          reference_site = "SiteA")
}
