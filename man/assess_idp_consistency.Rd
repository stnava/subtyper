% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/subtyper.R
\name{assess_idp_consistency}
\alias{assess_idp_consistency}
\title{Assess neuroscientific consistency between IDPs and performance domains}
\usage{
assess_idp_consistency(
  df,
  Perf.Dom,
  idp_cols,
  prompt = generate_idp_interpretation_prompt(),
  backend = c("groq", "openrouter"),
  api_key_env = NULL,
  model = NULL,
  required_fields = c("consistency", "justification", "plausibility"),
  max_retries = 5,
  retry_delay_base = 2,
  jitter = TRUE,
  temperature = 0.1,
  user_input_prompt = "Assess neuroscientific consistency and return JSON.",
  collapse_fn = function(x) paste(na.omit(x), collapse = ", "),
  parallel = FALSE,
  .options_furrr = furrr::furrr_options(),
  cache_dir = NULL,
  verbose = TRUE,
  skip_api_key_check = FALSE
)
}
\arguments{
\item{df}{A data frame with at least one performance domain column and IDP columns.}

\item{Perf.Dom}{Character, name of the column containing the performance domain.}

\item{idp_cols}{Character vector of column names containing IDPs.}

\item{prompt}{Character, system prompt. Default: see \code{generate_idp_interpretation_prompt}.}

\item{backend}{Character, API backend ("groq", "openrouter"). Default: "groq".}

\item{api_key_env}{Character, environment variable storing the API key. Default: NULL.}

\item{model}{Character, model name. Default: NULL (uses backend default).}

\item{required_fields}{Character vector, fields expected in API response. Default: c("consistency", "justification", "plausibility").}

\item{max_retries}{Integer, maximum API retry attempts. Default: 5.}

\item{retry_delay_base}{Numeric, base delay (seconds) for exponential backoff. Default: 2.}

\item{jitter}{Logical, add jitter to retry delays. Default: TRUE.}

\item{temperature}{Numeric, sampling temperature (0â€“1). Default: 0.1.}

\item{user_input_prompt}{Character, additional user prompt text. Default: "Assess neuroscientific consistency and return JSON."}

\item{collapse_fn}{Function, how to collapse IDPs into a string. Default: \code{function(x) paste(na.omit(x), collapse = ", ")}.}

\item{parallel}{Logical, use parallel processing with \code{furrr::future_map}. Default: FALSE.}

\item{.options_furrr}{List, options for \code{furrr::future_map}. Default: \code{furrr::furrr_options()}.}

\item{cache_dir}{Character, directory for caching API responses. Default: NULL.}

\item{verbose}{Logical, print debug information. Default: TRUE.}

\item{skip_api_key_check}{Logical, if TRUE, skip API key validation (useful for testing). Default: FALSE.}
}
\value{
A data frame with original data plus columns for \code{consistency}, \code{justification}, and \code{plausibility}.
}
\description{
Queries a language model API to evaluate the neuroscientific relationship between
imaging-derived phenotypes (IDPs) and a performance domain.
}
